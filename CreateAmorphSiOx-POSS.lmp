# ---------Initialize Simulation---------
clear
units         real
dimension     3
boundary    p p p
atom_style  charge
#atom_modify map array #likely is not needed


#timestep of 0.5 femptoseconds
variable dt equal .5 



# # ---------Create Atoms-------------------
# read_data data/POSS.data
# #(-1.93457 -1.92202 -1.94879) to (1.93593 1.96108 1.94931)
# change_box all x scale 4 y scale 4 z scale 4
# replicate 6 6 3

read_data data/SiOx-cool1.data

# ----------Define interatomic potential --------------
#Pair style reaxff requires use of exactly one of the fix qeq/reaxff or fix qeq/shielded or fix acks2/reaxff commands 
pair_style	    reaxff topcon.control
pair_coeff	    * * potential/ffield_Nayir_SiO_2019.reax H O Si

#skin distance of 2 angstrom
neighbor        2 bin
neigh_modify    every 10 delay 0 check no


timestep ${dt}


#qeq/reax uses the Rappe and Goddard QEq technique which was used in the potential in Fogarty2010(p2) that this current potential is. based on 
fix r1 all qeq/reax 1 0.0 10.0 1e-6 reaxff
run 0

# compute      myKE all ke/atom
# compute      myPE all pe/atom
# compute      myStress all stress/atom NULL virial
# compute      flux all heat/flux myKE myPE myStress

dump d1 all custom 5000 ${output_folder}CreateAmorphSiOx.dump id type q x y z ix iy iz mass element vx vy vz
dump_modify d1 element H O Si

thermo 5000
thermo_style custom step temp density

min_style hftn
minimize 1.0e-6 1.0e-6 1000 1000


velocity all create 2000.0 123456 mom yes rot yes dist gaussian  # mom and rot yes means net linear and angular momentum is zero
fix f1 all nvt temp 2000.0 2000.0 100
run $(100000*(1/v_dt))
unfix f1

fix f2 all deform 1 x final -20.2 20.2 y final -20.2 20.2 z final -10.4 10.4 remap v
fix f1 all nvt/sllod temp 1500 1500 100 
run $(100000*(1/v_dt))
unfix f1
unfix f2
write_data ${output_folder}SiOx-deform.data



fix f1 all nvt temp 3000 3000 100
run $(100000*(1/v_dt))
unfix f1
write_data ${output_folder}SiOx-heated.data


fix f1 all nvt temp 3000 1500 100
run $(100000*(1/v_dt))
unfix f1
write_data ${output_folder}SiOx-cool1.data


fix f1 all nvt temp 1500 350 100
run $(100000*(1/v_dt))
unfix f1
write_data ${output_folder}SiOx-cool2.data


fix f1 all nvt temp 350 350 100
run $(1000000*(1/v_dt))
write_data ${output_folder}SiOx-final-1.data

fix f1 all nvt temp 350 350 100
run $(1000000*(1/v_dt))
write_data ${output_folder}SiOx-final2.data

fix f1 all nvt temp 350 350 100
run $(1000000*(1/v_dt))
write_data ${output_folder}SiOx-final3.data
